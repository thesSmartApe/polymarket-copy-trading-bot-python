# 使用示例

Polymarket 跟单交易机器人常见任务的实用示例。

## 目录

1. [初始设置](#初始设置)
2. [查找和添加交易者](#查找和添加交易者)
3. [运行模拟](#运行模拟)
4. [监控和分析](#监控和分析)
5. [故障排除示例](#故障排除示例)

## 初始设置

### 完整的首次设置

```bash
# 1. 克隆并安装
git clone https://github.com/thesSmartApe/polymarket-copy-trading-bot-python.git
cd polymarket-copy-trading-bot-python/python
pip install -r requirements.txt

# 2. 运行设置向导
python -m src.scripts.setup.setup

# 3. 验证配置
python -m src.scripts.setup.system_status

# 4. 检查钱包并设置授权
python -m src.scripts.wallet.check_my_stats
python -m src.scripts.wallet.check_allowance

# 5. 启动机器人
python -m src.main
```

### 使用特定交易者设置

```bash
# 1. 首先找到好的交易者
python -m src.scripts.research.find_best_traders

# 2. 模拟他们的表现
python -m src.scripts.simulation.simulate_profitability
# 提示时输入交易者地址

# 3. 如果满意，添加到 .env
# 编辑 .env 文件：
# USER_ADDRESSES=0x7c3db723f1d4d8cb9c550095203b686cb11e5c6b,0x6bab41a0dc40d6dd4c1a915b8c01969479fd1292

# 4. 重启机器人
python -m src.main
```

## 查找和添加交易者

### 示例 1：查找顶级表现者

```bash
# 按 ROI 查找最佳交易者
python -m src.scripts.research.find_best_traders

# 输出：
# Rank | Address          | ROI    | Win Rate | P&L
# -----|------------------|--------|----------|-----
# 1    | 0x7c3d...        | 45.2%  | 62.5%    | $1,234
# 2    | 0x6bab...        | 38.7%  | 58.3%    | $987
```

### 示例 2：查找低风险交易者

```bash
# 查找保守交易者
python -m src.scripts.research.find_low_risk_traders

# 输出显示：
# - 夏普比率
# - 最大回撤
# - 波动率
# - 胜率
```

### 示例 3：扫描活跃市场

```bash
# 从活跃市场发现交易者
python -m src.scripts.research.scan_traders_from_markets

# 输出：
# Found 25 active traders
# Top 5 by activity:
# 1. 0xABC... - 45 trades today
# 2. 0xDEF... - 32 trades today
```

### 示例 4：添加前测试

```bash
# 模拟复制交易者
python -m src.scripts.simulation.simulate_profitability

# 输入：0x7c3db723f1d4d8cb9c550095203b686cb11e5c6b
# 天数：30
# 倍数：1.0

# 输出：
# Simulating 30 days of trading...
# [OK] Simulation complete
# 
# Results:
# - ROI: 12.5%
# - Total P&L: $125.50
# - Win Rate: 58.3%
# - Max Drawdown: 8.2%
# - Sharpe Ratio: 1.45
```

## 运行模拟

### 示例 1：快速模拟

```bash
# 运行快速 7 天模拟
python -m src.scripts.simulation.run_simulations quick

# 测试：
# - 7 天历史
# - 2 个倍数（1.0, 2.0）
# - 快速结果
```

### 示例 2：标准模拟

```bash
# 运行全面的 30 天模拟
python -m src.scripts.simulation.run_simulations standard

# 测试：
# - 30 天历史
# - 3 个倍数（0.5, 1.0, 2.0）
# - 推荐用于大多数情况
```

### 示例 3：自定义模拟

```bash
# 特定交易者的自定义模拟
python -m src.scripts.simulation.run_simulations custom 0x7c3db723f1d4d8cb9c550095203b686cb11e5c6b 30 2.0

# 参数：
# - 交易者：0x7c3d...
# - 天数：30
# - 倍数：2.0
```

### 示例 4：比较结果

```bash
# 运行模拟后，比较结果
python -m src.scripts.simulation.compare_results

# 显示前 5 个
python -m src.scripts.simulation.compare_results best 5

# 详细视图
python -m src.scripts.simulation.compare_results detail std_m2p0
```

## 监控和分析

### 示例 1：每日检查例程

```bash
# 早晨例程
python -m src.scripts.wallet.check_my_stats
python -m src.scripts.wallet.check_recent_activity
python -m src.scripts.wallet.check_positions_detailed
```

### 示例 2：性能分析

```bash
# 检查整体性能
python -m src.scripts.wallet.check_my_stats

# 输出：
# Wallet Statistics
# ================
# Total Balance: 1,250.50 USDC
# Active Positions: 12
# Total P&L: +$125.50 (+11.1%)
# Win Rate: 58.3%
# Best Position: +$45.20
# Worst Position: -$12.30
```

### 示例 3：与交易者比较

```bash
# 将您的表现与交易者比较
python -m src.scripts.wallet.check_both_wallets \
  0xYOUR_WALLET \
  0xTRADER_WALLET

# 显示：
# - 余额比较
# - 仓位比较
# - 活动比较
```

### 示例 4：盈亏分析

```bash
# 检查盈亏差异
python -m src.scripts.wallet.check_pnl_discrepancy

# 输出：
# P&L Discrepancy Analysis
# =======================
# Expected P&L: $125.50
# Actual P&L: $123.20
# Discrepancy: -$2.30 (-1.8%)
# 
# Possible causes:
# - Slippage
# - Gas fees
# - Timing differences
```

## 故障排除示例

### 示例 1：连接问题

```bash
# 检查系统状态
python -m src.scripts.setup.system_status

# 如果 MongoDB 失败：
# 1. 验证 .env 中的 MONGO_URI
# 2. 检查 MongoDB Atlas 中的 IP 白名单
# 3. 手动测试连接

# 如果 RPC 失败：
# 1. 验证 .env 中的 RPC_URL
# 2. 检查 API 密钥是否有效
# 3. 尝试不同的 RPC 端点
```

### 示例 2：余额问题

```bash
# 检查当前余额
python -m src.scripts.wallet.check_my_stats

# 如果 USDC 不足：
# 1. 向钱包添加 USDC
# 2. 验证余额已更新
# 3. 检查授权

# 如果 MATIC 不足：
# 1. 添加 MATIC 用于 gas
# 2. 推荐：1-2 MATIC
```

### 示例 3：机器人未交易

```bash
# 检查交易者是否活跃
python -m src.scripts.wallet.check_recent_activity

# 验证交易者地址
python -m src.scripts.setup.system_status

# 检查交易者是否真的在交易
# 访问 Polymarket 并检查他们的活动

# 验证机器人正在运行
# 检查日志：logs/bot-YYYY-MM-DD.log
```

### 示例 4：授权问题

```bash
# 检查当前授权
python -m src.scripts.wallet.verify_allowance

# 如果不足，设置授权
python -m src.scripts.wallet.check_allowance

# 按照提示：
# Current allowance: 0 USDC
# Required: 1000 USDC
# [?] Set allowance? (y/n): y
# [INFO] Approving USDC...
# [OK] Allowance set successfully
```

## 高级示例

### 示例 1：批量模拟分析

```bash
# 1. 运行多个模拟
python -m src.scripts.simulation.run_simulations standard

# 2. 聚合结果
python -m src.scripts.simulation.aggregate_results

# 3. 比较策略
python -m src.scripts.simulation.compare_results stats
```

### 示例 2：预缓存历史数据

```bash
# 获取多个交易者的历史数据
python -m src.scripts.simulation.fetch_historical_trades

# 数据缓存到 trader_data_cache/
# 加快未来模拟速度
```

### 示例 3：审计机器人性能

```bash
# 审计跟单交易算法
python -m src.scripts.simulation.audit_copy_trading

# 比较：
# - 模拟结果
# - 实际机器人性能
# - 识别差异
```

### 示例 4：多交易者策略

```bash
# 1. 找到多个好的交易者
python -m src.scripts.research.find_best_traders
python -m src.scripts.research.find_low_risk_traders

# 2. 测试每一个
python -m src.scripts.simulation.simulate_profitability
# 测试交易者 1
python -m src.scripts.simulation.simulate_profitability
# 测试交易者 2

# 3. 将最佳表现者添加到 .env
# USER_ADDRESSES=0xTRADER1,0xTRADER2,0xTRADER3

# 4. 使用多样化的交易者启动机器人
python -m src.main
```

## 工作流程示例

### 每日交易工作流程

```bash
# 早晨（9 AM）
python -m src.scripts.wallet.check_my_stats
python -m src.scripts.wallet.check_recent_activity

# 启动机器人
python -m src.main

# 晚上（6 PM）
# 停止机器人（Ctrl+C）
python -m src.scripts.wallet.check_my_stats
python -m src.scripts.wallet.check_positions_detailed
```

### 每周审查工作流程

```bash
# 周一：审查性能
python -m src.scripts.wallet.check_my_stats
python -m src.scripts.wallet.check_pnl_discrepancy

# 周二：研究新交易者
python -m src.scripts.research.find_best_traders
python -m src.scripts.research.scan_traders_from_markets

# 周三：测试新交易者
python -m src.scripts.simulation.simulate_profitability

# 周四：如果需要，更新配置
python -m src.scripts.setup.setup

# 周五：运行全面分析
python -m src.scripts.simulation.run_simulations standard
python -m src.scripts.simulation.compare_results
```

### 每月分析工作流程

```bash
# 1. 运行完整模拟
python -m src.scripts.simulation.run_simulations full

# 2. 聚合所有结果
python -m src.scripts.simulation.aggregate_results

# 3. 审计机器人性能
python -m src.scripts.simulation.audit_copy_trading

# 4. 审查和优化
python -m src.scripts.simulation.compare_results stats
```

---

有关更多信息，请参阅：
- [入门指南](入门指南.md)
- [命令参考](命令参考.md)
- [高级功能](ADVANCED_FEATURES.md)
